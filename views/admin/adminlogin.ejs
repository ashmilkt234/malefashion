<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Portal</title>
  <link rel="stylesheet" href="/css/adminlogin.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link rel="stylesheet" href="/css/adminlogin.css">
  <link rel="shortcut icon" href="/img/hero/cr.jpg" type="image/png">
</head>
<body>
  <div class="particles" id="particles"></div>
  
  <div class="login-container">
    <div class="logo-section">
      <h1>Admin Login</h1>
    </div>

    <form id="loginForm">
      <div class="form-group">
        <input type="text" class="input-field" placeholder="Username or Email" id="username" name="email" value="<%= typeof email !== 'undefined' ? email : '' %>">
      </div>

      <div class="form-group">
        <input type="password" class="input-field" placeholder="Password" id="password" name="password">
        <div class="password-toggle" id="togglePassword"></div>
      </div>

      <button type="submit" class="login-btn" id="loginBtn">
        <span id="btnText">Sign In</span>
        <div class="loading" id="loading"></div>
      </button>
    </form>
  </div>

  <script>
    // Particles background
    function createParticles() {
      const particles = document.getElementById('particles');
      const particleCount = 50;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        
        const size = Math.random() * 4 + 1;
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 6 + 's';
        particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
        
        particles.appendChild(particle);
      }
    }

    // Toggle password visibility
    const passwordInput = document.getElementById("password");
    const togglePassword = document.getElementById("togglePassword");

    togglePassword.addEventListener("click", () => {
      if (passwordInput.type === "password") {
        passwordInput.type = "text";
        togglePassword.classList.add("hide");
      } else {
        passwordInput.type = "password";
        togglePassword.classList.remove("hide");
      }
    });

   
    


    window.addEventListener('load', createParticles);

document.getElementById('loginForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();
    const btnText = document.getElementById('btnText');
    const loading = document.getElementById('loading');
    const btn = document.getElementById('loginBtn');

    if (!username || !password) {
        Swal.fire({
            icon: 'warning',
            title: 'Missing fields',
            text: 'Please enter both email and password'
        });
        return;
    }

    btnText.textContent = 'Signing In...';
    loading.style.display = 'inline-block';
    btn.disabled = true;

    try {
        const response = await fetch('/admin/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email: username, password: password })
        });

        const data = await response.json();

   if (data.success) {
    Swal.fire({
        icon: 'success',
        title: 'Success',
        text: data.message, // <-- This now shows "Welcome Admin!"
        timer: 1500,
        showConfirmButton: false
    }).then(() => {
        window.location.href = '/admin/dashboard';
    });
} else {
    Swal.fire({
        icon: 'error',
        title: 'Login Failed',
        text: data.message
    });
}


    // } catch (error) {
    //     Swal.fire(           {
    //         icon: 'error',
    //         title: 'Server Error',
    //         text: 'Please try again later'
    //   });
    } finally {
        btnText.textContent = 'Sign In';
        loading.style.display = 'none';
        btn.disabled = false;
    }
});


        

    
  </script>
</body>
</html>
